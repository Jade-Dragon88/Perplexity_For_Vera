{"createdAt":"2025-07-29T08:35:53.483Z","updatedAt":"2025-08-14T12:24:17.926Z","id":"VZP3jdU9iIZxeEK8","name":"Perplexity_For_Vera","active":false,"isArchived":false,"nodes":[{"parameters":{"method":"POST","url":"https://api.perplexity.ai/chat/completions","authentication":"genericCredentialType","genericAuthType":"httpHeaderAuth","sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"model\": \"sonar-reasoning-pro\",\n  \"messages\": [\n    {\n      \"role\": \"system\",\n      \"content\": \"–†–û–õ–¨: –¢—ã ‚Äî –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫ –∏ –ª–∏—á–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á –≤ —Ä–æ—Å—Å–∏–π—Å–∫–æ–π —é—Ä–∏—Å–¥–∏–∫—Ü–∏–∏. –ó–ê–î–ê–ß–ê: –ü—Ä–µ–¥–æ—Å—Ç–∞–≤—å –ø–æ–ª–Ω—ã–π –∏ –∞–∫—Ç—É–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç –Ω–∞ –∑–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∏—Å–ø–æ–ª—å–∑—É—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é. –ü–û–î–•–û–î –ö –†–ï–®–ï–ù–ò–Æ: 1.–†–∞–∑–±–µ–π —Å–ª–æ–∂–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –Ω–∞ –ø—Ä–æ—Å—Ç—ã–µ –ø–æ–¥–≤–æ–ø—Ä–æ—Å—ã; 2.–ò—â–∏ –∞–∫—Ç—É–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ—ç—Ç–∞–ø–Ω–æ; 3.–°–æ–±–∏—Ä–∞–π –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –¥–∞–Ω–Ω—ã–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ; 4.–§–æ—Ä–º—É–ª–∏—Ä—É–π –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –æ—Ç–≤–µ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–π–¥–µ–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏. –ì–ï–û–ì–†–ê–§–ò–ß–ï–°–ö–ò–ô –ö–û–ù–¢–ï–ö–°–¢: –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∫–∞—Å–∞—é—Ç—Å—è –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –∏ —Ç–æ–ª—å–∫–æ –†–æ—Å—Å–∏–π—Å–∫–æ–π –§–µ–¥–µ—Ä–∞—Ü–∏–∏, –µ—Å–ª–∏ –∏–Ω–æ–µ –Ω–µ —É–∫–∞–∑–∞–Ω–æ —è–≤–Ω–æ. –§–û–†–ú–ê–¢ –û–¢–í–ï–¢–ê: 1.–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏ –ø–æ–Ω—è—Ç–Ω—ã–π –æ—Ç–≤–µ—Ç; 2.–ê–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤; 3.–ë–µ–∑ –æ–ø–∏—Å–∞–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø–æ–∏—Å–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏; 4.–í –∫–æ–Ω—Ü–µ –æ—Ç–≤–µ—Ç–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–∏–≤–µ–¥–∏ —Ä–∞–∑–¥–µ–ª '–ò—Å—Ç–æ—á–Ω–∏–∫–∏' —Å–æ –≤—Å–µ–º–∏ —Å—Å—ã–ª–∫–∞–º–∏ –Ω–∞ –ø–µ—Ä–≤–æ–∏—Å—Ç–æ—á–Ω–∏–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –ø—Ä–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ –æ—Ç–≤–µ—Ç–∞. –û–ì–†–ê–ù–ò–ß–ï–ù–ò–Ø: 1.–ò—Å–ø–æ–ª—å–∑—É–π —Ç–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—É—é –∏ –∞–∫—Ç—É–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é; 2.–ù–µ –æ–ø–∏—Å—ã–≤–∞–π –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—é —Ä–µ—à–µ–Ω–∏—è –≤ —Ñ–∏–Ω–∞–ª—å–Ω–æ–º –æ—Ç–≤–µ—Ç–µ; 3.–§–æ–∫—É—Å–∏—Ä—É–π—Å—è –Ω–∞ —Ä–æ—Å—Å–∏–π—Å–∫–æ–º –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–µ –∏ –ø—Ä–∞–∫—Ç–∏–∫–µ\"\n    },\n    {\n      \"role\": \"user\",\n        \"content\": \"–ú–ê–ö–°–ò–ú–ê–õ–¨–ù–û –î–ï–¢–ê–õ–¨–ù–û –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —Å–ª–µ–¥—É—é—â–∏–π –∑–∞–ø—Ä–æ—Å: '{{ $json.message.text }}'.\"\n    }\n  ]\n}\n","options":{}},"id":"be729536-b32d-482a-9df2-3a17a4f36b07","name":"Perplexity Research","type":"n8n-nodes-base.httpRequest","position":[-80,368],"typeVersion":4.2,"credentials":{"httpHeaderAuth":{"id":"t6CVMb8vvWuOVhLV","name":"Header Auth Perplexity"}},"onError":"continueErrorOutput"},{"parameters":{"updates":["*"],"additionalFields":{}},"type":"n8n-nodes-base.telegramTrigger","typeVersion":1.1,"position":[-480,368],"id":"59b8bfa0-8f23-4382-94e5-62888c785cc0","name":"Telegram Trigger","webhookId":"32792b6a-4e66-4cef-8b79-5ad1df050e15","notesInFlow":false,"credentials":{"telegramApi":{"id":"H9CNjG766aRTK63z","name":"Perplexity_For_Vera"}}},{"parameters":{"chatId":"={{ $('Telegram Trigger').all()[0].json.message.chat.id }}","text":"={{ $json.output }}","additionalFields":{"appendAttribution":false,"parse_mode":"HTML"}},"type":"n8n-nodes-base.telegram","typeVersion":1.2,"position":[128,768],"id":"7a309bd2-f602-4042-9a98-406c0cc3a85d","name":"Send a text message","webhookId":"af714694-db5b-4f3f-8e41-c157f823855d","credentials":{"telegramApi":{"id":"H9CNjG766aRTK63z","name":"Perplexity_For_Vera"}},"onError":"continueErrorOutput"},{"parameters":{"jsCode":"const MAX_MESSAGE_LENGTH = 4000;\nconst originalText = $input.all()[0].json.text;\n\nfunction extractCleanText(text) {\n  if (!text) return '';\n  \n  let cleanText = '';\n  \n  // 1. –ü—Ä–æ–±—É–µ–º –Ω–∞–π—Ç–∏ —Ç–µ–∫—Å—Ç –ø–æ—Å–ª–µ </think\\> (–≤–∞—à –≤–∞—Ä–∏–∞–Ω—Ç)\n  if (text.includes('</think\\\\>')) {\n    const parts = text.split('</think\\\\>');\n    cleanText = parts[parts.length - 1]; // –±–µ—Ä–µ–º –ø–æ—Å–ª–µ–¥–Ω—é—é —á–∞—Å—Ç—å\n  }\n  // 2. –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω, –ø—Ä–æ–±—É–µ–º –æ–±—ã—á–Ω—ã–π </think>\n  else if (text.includes('</think>')) {\n    const parts = text.split('</think>');\n    cleanText = parts[parts.length - 1]; // –±–µ—Ä–µ–º –ø–æ—Å–ª–µ–¥–Ω—é—é —á–∞—Å—Ç—å\n  }\n  // 3. –ï—Å–ª–∏ –Ω–µ—Ç –∑–∞–∫—Ä—ã–≤–∞—é—â–∏—Ö —Ç–µ–≥–æ–≤, –±–µ—Ä–µ–º –≤–µ—Å—å —Ç–µ–∫—Å—Ç\n  else {\n    cleanText = text;\n  }\n  \n  // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞\n  cleanText = cleanText\n    .replace(/<\\/?think\\\\?>/g, '') // —É–¥–∞–ª—è–µ–º –æ—Å—Ç–∞–≤—à–∏–µ—Å—è —Ç–µ–≥–∏ think\n    .replace(/^[\"'\\s]+|[\"'\\s]+$/g, '') // —É–±–∏—Ä–∞–µ–º –∫–∞–≤—ã—á–∫–∏ –≤ –Ω–∞—á–∞–ª–µ/–∫–æ–Ω—Ü–µ\n    .replace(/\\\\([.,:;!?])/g, '$1') // —É–±–∏—Ä–∞–µ–º —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–Ω–∞–∫–æ–≤ –ø—Ä–µ–ø–∏–Ω–∞–Ω–∏—è\n    .replace(/\\s+/g, ' ') // –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ–º –ø—Ä–æ–±–µ–ª—ã\n    .trim();\n  \n  return cleanText;\n}\n\nfunction splitText(text, maxLength) {\n  if (text.length <= maxLength) {\n    return [text];\n  }\n  \n  const parts = [];\n  let currentPart = '';\n  const words = text.split(' ');\n  \n  for (const word of words) {\n    if ((currentPart + ' ' + word).length > maxLength) {\n      if (currentPart) {\n        parts.push(currentPart.trim());\n        currentPart = word;\n      } else {\n        // –ï—Å–ª–∏ –æ–¥–Ω–æ —Å–ª–æ–≤–æ –±–æ–ª—å—à–µ –ª–∏–º–∏—Ç–∞, —Ä–∞–∑—Ä–µ–∑–∞–µ–º –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ\n        const chunks = word.match(new RegExp(`.{1,${maxLength}}`, 'g'));\n        parts.push(...chunks.slice(0, -1));\n        currentPart = chunks[chunks.length - 1];\n      }\n    } else {\n      currentPart += (currentPart ? ' ' : '') + word;\n    }\n  }\n  \n  if (currentPart) {\n    parts.push(currentPart.trim());\n  }\n  \n  return parts;\n}\n\n// –ò–∑–≤–ª–µ–∫–∞–µ–º —á–∏—Å—Ç—ã–π —Ç–µ–∫—Å—Ç\nconst cleanText = extractCleanText(originalText);\n\n// –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç\nif (!cleanText || cleanText.length < 5) {\n  return [{\n    json: {\n      text: \"–¢–µ–∫—Å—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π –ø–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏\",\n      cleanText: cleanText,\n      originalLength: originalText ? originalText.length : 0\n    }\n  }];\n}\n\n// –†–∞–∑–±–∏–≤–∞–µ–º –Ω–∞ —á–∞—Å—Ç–∏ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ\nconst textParts = splitText(cleanText, MAX_MESSAGE_LENGTH);\n\n// –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç\nreturn textParts.map((part, index) => ({\n  json: {\n    text: textParts.length > 1 ? `üìù –ß–∞—Å—Ç—å ${index + 1}/${textParts.length}\\n\\n${part}` : part,\n    cleanText: part,\n    part: index + 1,\n    total_parts: textParts.length\n  }\n}));\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[336,368],"id":"76452a70-d20b-40c5-9756-a40e4456c858","name":"Delete_Think_Block","onError":"continueErrorOutput"},{"parameters":{"model":{"__rl":true,"value":"gpt://b1g9v3gfrgpacf17n0e9/yandexgpt/latest","mode":"list","cachedResultName":"gpt://b1g9v3gfrgpacf17n0e9/yandexgpt/latest"},"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[-240,928],"id":"2024fa88-3ac0-4773-b192-e9275f489aed","name":"YandexGPT1","credentials":{"openAiApi":{"id":"ONqffXNvtrH17VKj","name":"Yandex GPT"}}},{"parameters":{"mode":"runOnceForEachItem","jsCode":"{{\nconst text = $input.item.json.cleanText;\nconst escaped = text.replace(/[_*[\\]()~`>#+\\-=|{}.!]/g, '\\\\$&');\nreturn { json: { escaped_text: escaped } };\n}}"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[544,368],"id":"dd4cd80a-e65e-4660-b932-bc92cbd7377f","name":"–≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –¢–µ–ª–µ–≥—Ä–∞–º","onError":"continueErrorOutput"},{"parameters":{"chatId":"={{ $('Telegram Trigger').all()[0].json.message.chat.id }}","text":"={{ $json.escaped_text }}","additionalFields":{"appendAttribution":false,"parse_mode":"MarkdownV2"}},"type":"n8n-nodes-base.telegram","typeVersion":1.2,"position":[944,768],"id":"b81c2029-6d3c-4515-8194-bcdc5c22f1e5","name":"On Error","webhookId":"7ce4eba0-a513-4a42-ab29-6e705573ef76","credentials":{"telegramApi":{"id":"HcGQaqmp9jWexBXY","name":"Yurist_RB_test_bot"}}},{"parameters":{"model":{"__rl":true,"value":"gpt://b1g9v3gfrgpacf17n0e9/yandexgpt/latest","mode":"id"},"options":{"maxTokens":4000,"temperature":0.2}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[432,928],"id":"679db2b8-a36b-4ae7-bb7b-e2957a3b77ea","name":"Yandex GPT2","credentials":{"openAiApi":{"id":"ONqffXNvtrH17VKj","name":"Yandex GPT"}}},{"parameters":{"jsCode":"const text = $input.first().json.output;\nconst escaped = text.replace(/[_*[\\]()~`>#+\\-=|{}.!]/g, '\\\\$&');\nreturn { json: { escaped_text: escaped } };"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[720,768],"id":"779c48ab-c27b-4b80-aec1-032630127c16","name":"–≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø–µ—Ü.—Å–∏–º–≤–æ–ª–æ–≤"},{"parameters":{},"type":"n8n-nodes-base.noOp","typeVersion":1,"position":[128,576],"id":"b6726185-ec1e-4ac1-be47-b1c946cc1b0b","name":"."},{"parameters":{"height":304,"width":640,"color":4},"type":"n8n-nodes-base.stickyNote","position":[-288,736],"typeVersion":1,"id":"9e309cbf-dd8b-4b7d-8893-d03d09338b2f","name":"Sticky Note"},{"parameters":{"height":304,"width":752,"color":3},"type":"n8n-nodes-base.stickyNote","position":[384,736],"typeVersion":1,"id":"902622df-8111-488a-8865-a323d1e26600","name":"Sticky Note1"},{"parameters":{"promptType":"define","text":"={{ $json.error }}","options":{"systemMessage":"=–ú–ê–ö–°–ò–ú–ê–õ–¨–ù–û –î–ï–¢–ê–õ–¨–ù–û, –í–ü–õ–û–¢–¨ –î–û –ö–ê–ñ–î–û–ì–û –ó–ù–ê–ö–ê –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —Ç–µ–∫—Å—Ç, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.\n–î–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –≤—ã–¥–∞–ª —É–∑–µ–ª \"{{ $json.NodeName }}\"\n–ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –¥–æ–∫–º–µ–Ω—Ç–æ–º {{ $json.ActName }}\n–ú–ê–ö–°–ò–ú–ê–õ–¨–ù–û –ö–†–ê–¢–ö–û –Ω–∞–ø–∏—à–∏ –°–£–¢–¨ –æ—à–∏–±–∫–∏\n–î–∞–π –ö–†–ê–¢–ö–û–ï –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã –æ—à–∏–±–∫–∏.\n–ë–ï–ó —Ç–≤–æ–∏—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π. \n–ë–ï–ó —Ä–∞–∑—ä—è—Å–Ω–µ–Ω–∏—è –∞–Ω–∞–ª–∏–∑–∞.\n–ë–ï–ó –∫–∞–∫–∏—Ö-–ª–∏–±–æ –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–π.\n–ò–≥–Ω–æ—Ä–∏—Ä—É–π –∫–ª—é—á \"stack\" –ü–û–õ–ù–û–°–¢–¨–Æ\n–ò–°–ö–õ–Æ–ß–ò–¢–ï–õ–¨–ù–û —Å—É—Ç—å –æ—à–∏–±–∫–∏ –∏ –∫—Ä–∞—Ç–∫–æ–µ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏–µ\n\n–ü—Ä–∏–º–µ—Ä –≥—Ä–∞–º–æ—Ç–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞:\n\"\n!!! –í–Ω–∏–º–∞–Ω–∏–µ !!!\nWorkflow –∑–∞–∫–æ–Ω—á–∏–ª —Ä–∞–±–æ—Ç—É —Å –æ—à–∏–±–∫–æ–π\n‚óè –£–∑–µ–ª:\n  \"GET PDF FILE\"\n‚óè –î–æ–∫—É–º–µ–Ω—Ç (–µ—Å–ª–∏ –æ–Ω —É–∫–∞–∑–∞–Ω):\n  \"–ü–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ ‚Ññ123 –æ—Ç 2021.01.01\"\n‚óè –°—É—Ç—å –æ—à–∏–±–∫–∏:\n  HTTP 404 (Not Found) ‚Äî –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã–π PDF-—Ñ–∞–π–ª –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ\n‚óè –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º–∞—è –ø—Ä–∏—á–∏–Ω–∞:\n  –ù–µ–≤–µ—Ä–Ω—ã–π URL, –ø–µ—Ä–µ–º–µ—â—ë–Ω–Ω—ã–π –∏–ª–∏ —É–¥–∞–ª—ë–Ω–Ω—ã–π —Ñ–∞–π–ª\n\""}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.8,"position":[432,768],"id":"08dd356b-f362-4e4c-9d79-8ccd1957a907","name":"Yandex GPT Create Error"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"1bab28a2-5656-4449-a0c9-6c3e186c4c97","leftValue":"={{ $json.message.entities[0].type }}","rightValue":"=bot_command","operator":{"type":"string","operation":"notContains"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-288,368],"id":"b3eaa16d-ec26-4b32-b3de-f0aea0943336","name":"If"},{"parameters":{"chatId":"={{ $('Telegram Trigger').all()[0].json.message.chat.id }}","text":"=–ü—Ä–∏–≤–µ—Ç, {{ $json.message.from.first_name }} !\n–ù–∞–ø–∏—à–∏ –º–Ω–µ —Å–≤–æ–π –≤–æ–ø—Ä–æ—Å –∏ —è –Ω–∞–π–¥—É –ø–æ–¥—Ä–æ–±–Ω—É—é –∏ —Ç–æ—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.\n–£–ß–¢–ò! \n–£ –º–µ–Ω—è –Ω–µ—Ç –ø–∞–º—è—Ç–∏ (–Ω–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç): –∫–∞–∂–¥–æ–µ —Ç–≤–æ—ë —Å–æ–æ–±—â–µ–Ω–∏–µ - –∫–∞–∫ –Ω–æ–≤—ã–π –¥–∏–∞–ª–æ–≥.","additionalFields":{"appendAttribution":false,"parse_mode":"HTML"}},"type":"n8n-nodes-base.telegram","typeVersion":1.2,"position":[-128,560],"id":"a0d0a649-5f65-4ad4-b269-a05724e9c724","name":"Send a text message1","webhookId":"af714694-db5b-4f3f-8e41-c157f823855d","credentials":{"telegramApi":{"id":"H9CNjG766aRTK63z","name":"Perplexity_For_Vera"}},"onError":"continueErrorOutput"},{"parameters":{"promptType":"define","text":"={{ $json.escaped_text }}","options":{"systemMessage":"=–†–û–õ–¨:\n–¢—ã ‚Äî —Ä–µ–¥–∞–∫—Ç–æ—Ä —Ç–µ–∫—Å—Ç–∞ –¥–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∫ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –≤ –¢–µ–ª–µ–≥—Ä–∞–º.\n\n–ó–ê–î–ê–ß–ê:\n–û—á–∏—Å—Ç–∏ –≤—Ö–æ–¥–Ω–æ–π —Ç–µ–∫—Å—Ç –æ—Ç –ª–∏—à–Ω–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∏ Markdown-—Ä–∞–∑–º–µ—Ç–∫–∏, —Å–æ—Ö—Ä–∞–Ω–∏–≤ —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –¥–ª—è –¢–µ–ª–µ–≥—Ä–∞–º.\n\n–ß–¢–û –£–î–ê–õ–ò–¢–¨:\n- –û–±—Ä–∞—Ç–Ω—ã–µ —Å–ª–µ—à–∏ –ø–µ—Ä–µ–¥ —Å–∏–º–≤–æ–ª–∞–º–∏: `\\*`, `\\_`, `$$`, `$$`, `$$`, `$$`\n- Markdown-—Ä–∞–∑–º–µ—Ç–∫—É: `**`, `*`, `__`, `_`, `#`, `##`, `###`, `` ` ``, `` ``` ``\n- HTML-—Ç–µ–≥–∏: ``, ``, ``, ``, ``, ``\n- –õ–∏—à–Ω–∏–µ –ø–µ—Ä–µ–Ω–æ—Å—ã —Å—Ç—Ä–æ–∫ (–±–æ–ª–µ–µ –¥–≤—É—Ö –ø–æ–¥—Ä—è–¥)\n\n–ß–¢–û –°–û–•–†–ê–ù–ò–¢–¨:\n- –°–º—ã—Å–ª–æ–≤—ã–µ –∑–Ω–∞–∫–∏ –ø—Ä–µ–ø–∏–Ω–∞–Ω–∏—è\n- –°—Ç—Ä—É–∫—Ç—É—Ä—É –∞–±–∑–∞—Ü–µ–≤\n- –ù—É–º–µ—Ä–∞—Ü–∏—é –∏ –º–∞—Ä–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ø–∏—Å–∫–∏ (–Ω–æ –±–µ–∑ Markdown-—Å–∏–º–≤–æ–ª–æ–≤)\n\n–§–û–†–ú–ê–¢ –û–¢–í–ï–¢–ê:\n–í—ã–≤–µ–¥–∏ —Ç–æ–ª—å–∫–æ –æ—á–∏—â–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤.\n\n–ü–†–ò–ú–ï–†:\n\n–í—Ö–æ–¥–Ω–æ–π —Ç–µ–∫—Å—Ç:\n```\n## –ó–∞–≥–æ–ª–æ–≤–æ–∫\\: –≤–∞–∂–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è\n\n\\* **–ü—É–Ω–∫—Ç 1** \\- –æ–ø–∏—Å–∞–Ω–∏–µ\n\\* *–ü—É–Ω–∫—Ç 2* \\- `–∫–æ–¥`\n\n[–°—Å—ã–ª–∫–∞](example\\.com)\n```\n\n–í—ã—Ö–æ–¥–Ω–æ–π —Ç–µ–∫—Å—Ç –ø–æ—Å–ª–µ —Ç–≤–æ–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏:\n```\n–ó–∞–≥–æ–ª–æ–≤–æ–∫: –≤–∞–∂–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è\n\n-  –ü—É–Ω–∫—Ç 1 - –æ–ø–∏—Å–∞–Ω–∏–µ\n-  –ü—É–Ω–∫—Ç 2 - –∫–æ–¥\n\nexample.com\n```\n\n–û–ì–†–ê–ù–ò–ß–ï–ù–ò–Ø:\n- –ù–µ –¥–æ–±–∞–≤–ª—è–π –ø–æ—è—Å–Ω–µ–Ω–∏—è –∏–ª–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ –ø—Ä–æ—Ü–µ—Å—Å—É –æ—á–∏—Å—Ç–∫–∏\n- –ù–µ –º–µ–Ω—è–π —Å–º—ã—Å–ª —Ç–µ–∫—Å—Ç–∞, —Ç–æ–ª—å–∫–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ\n- –°–æ—Ö—Ä–∞–Ω—è–π –ª–æ–≥–∏—á–µ—Å–∫—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –æ—Ä–∏–≥–∏–Ω–∞–ª–∞"}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2.1,"position":[-240,768],"id":"f849c709-56c3-4e50-ae62-84c0f23b69c3","name":"Reformat For Telegram","onError":"continueErrorOutput"},{"parameters":{},"type":"n8n-nodes-base.noOp","typeVersion":1,"position":[336,576],"id":"99371c1b-e102-4ca6-9f93-9cbc86dc9e74","name":".."},{"parameters":{},"type":"n8n-nodes-base.noOp","typeVersion":1,"position":[544,576],"id":"c3dc447b-bdef-455d-8bff-3898e4a1a096","name":"..."},{"parameters":{},"type":"n8n-nodes-base.noOp","typeVersion":1,"position":[752,576],"id":"2b89272f-3018-4789-951d-96988a65e72e","name":"...."},{"parameters":{"assignments":{"assignments":[{"id":"2944b985-89d5-4ebc-994a-4f008f1f39c4","name":"text","value":"={{\n$json.choices[0].message.content.replace(/\\[(\\d+)\\]/g, (match, num) => {\n  const index = parseInt(num) - 1;\n  const citations = $json.citations || [];\n  if (citations[index]) {\n    return `[${citations[index]}]`;\n  } else {\n    return ''; // —É–¥–∞–ª—è–µ–º —Å–Ω–æ—Å–∫—É, –µ—Å–ª–∏ –∏—Å—Ç–æ—á–Ω–∏–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω\n  }\n})\n}}\n","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[128,368],"id":"e518fa09-e6ec-4b7a-b4e1-dc8d617af2b9","name":"Change Links","onError":"continueErrorOutput"}],"connections":{"Perplexity Research":{"main":[[{"node":"Change Links","type":"main","index":0}],[{"node":".","type":"main","index":0}]]},"Telegram Trigger":{"main":[[{"node":"If","type":"main","index":0}]]},"Send a text message":{"main":[[],[{"node":"..","type":"main","index":0}]]},"Delete_Think_Block":{"main":[[{"node":"–≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –¢–µ–ª–µ–≥—Ä–∞–º","type":"main","index":0}],[{"node":"...","type":"main","index":0}]]},"YandexGPT1":{"ai_languageModel":[[{"node":"Reformat For Telegram","type":"ai_languageModel","index":0}]]},"–≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –¢–µ–ª–µ–≥—Ä–∞–º":{"main":[[{"node":"Reformat For Telegram","type":"main","index":0}],[{"node":"....","type":"main","index":0}]]},"Yandex GPT2":{"ai_languageModel":[[{"node":"Yandex GPT Create Error","type":"ai_languageModel","index":0}]]},"–≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø–µ—Ü.—Å–∏–º–≤–æ–ª–æ–≤":{"main":[[{"node":"On Error","type":"main","index":0}]]},".":{"main":[[{"node":"..","type":"main","index":0}]]},"Yandex GPT Create Error":{"main":[[{"node":"–≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø–µ—Ü.—Å–∏–º–≤–æ–ª–æ–≤","type":"main","index":0}]]},"If":{"main":[[{"node":"Perplexity Research","type":"main","index":0}],[{"node":"Send a text message1","type":"main","index":0}]]},"Send a text message1":{"main":[[],[{"node":".","type":"main","index":0}]]},"Reformat For Telegram":{"main":[[{"node":"Send a text message","type":"main","index":0}],[{"node":".","type":"main","index":0}]]},"..":{"main":[[{"node":"...","type":"main","index":0}]]},"...":{"main":[[{"node":"....","type":"main","index":0}]]},"....":{"main":[[{"node":"Yandex GPT Create Error","type":"main","index":0}]]},"Change Links":{"main":[[{"node":"Delete_Think_Block","type":"main","index":0}],[{"node":"..","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"73b5128e-c695-4e5a-adb3-48c42c777ff3","triggerCount":1,"shared":[{"createdAt":"2025-07-29T08:35:53.483Z","updatedAt":"2025-07-29T08:35:53.483Z","role":"workflow:owner","workflowId":"VZP3jdU9iIZxeEK8","projectId":"2aYDbJAthPdR3hBL","project":{"createdAt":"2025-02-02T15:37:04.955Z","updatedAt":"2025-02-04T07:40:44.413Z","id":"2aYDbJAthPdR3hBL","name":"Oleg Ovchinnikov <oleg19091988@gmail.com>","type":"personal","icon":null,"description":null,"projectRelations":[{"createdAt":"2025-02-02T15:37:04.955Z","updatedAt":"2025-02-02T15:37:04.955Z","role":"project:personalOwner","userId":"c59bb383-18bc-4b63-a433-da7ed3447ae2","projectId":"2aYDbJAthPdR3hBL","user":{"createdAt":"2025-02-02T15:37:04.955Z","updatedAt":"2025-08-13T21:00:01.844Z","id":"c59bb383-18bc-4b63-a433-da7ed3447ae2","email":"oleg19091988@gmail.com","firstName":"Oleg","lastName":"Ovchinnikov","personalizationAnswers":{"version":"v4","personalization_survey_submitted_at":"2025-02-04T07:41:51.160Z","personalization_survey_n8n_version":"1.76.1","automationGoalDevops":[],"companySize":"<20","companyType":"education","role":"it","reportedSource":"friend"},"settings":{"easyAIWorkflowOnboarded":true,"firstSuccessfulWorkflowId":"BVH7vT81Bh0WzLSc","userActivated":true,"userActivatedAt":1738791768104,"npsSurvey":{"waitingForResponse":true,"ignoredCount":1,"lastShownAt":1754817044760}},"role":"global:member","disabled":false,"mfaEnabled":false,"lastActiveAt":"2025-08-13","isPending":false}}]}}],"tags":[]}